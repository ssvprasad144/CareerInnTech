{% extends "base.html" %}
{% block content %}

<div style="max-width:800px;margin:40px auto;color:white;">
  <h2>ðŸ‘‹ Welcome to AI Career Bot</h2>

  <div id="chatMessages"
       style="height:400px;overflow-y:auto;background:#0f172a;
              padding:16px;border-radius:10px;margin-bottom:12px;">
    <div><b>AI:</b> Ask me anything.</div>
  </div>

  <div style="display:flex;gap:10px;">
    <input id="chatInput"
           placeholder="Type your question..."
           style="flex:1;padding:12px;border-radius:6px;" />

    <button type="button"
            onclick="sendMessage()"
            style="padding:12px 20px;border-radius:6px;">
      Send
    </button>
  </div>
</div>

<script>
function sendMessage() {
  const input = document.getElementById("chatInput");
  const msg = input.value.trim();
  if (!msg) return;

  const box = document.getElementById("chatMessages");
  box.innerHTML += `<div><b>You:</b> ${msg}</div>`;
  input.value = "";

  fetch("/ai/chat/", {
    method: "POST",
    credentials: "same-origin",
    headers: {
      "Content-Type": "application/x-www-form-urlencoded"
    },
    body: `message=${encodeURIComponent(msg)}`
  })
  .then(res => res.json())
  .then(data => {
    box.innerHTML += `<div><b>AI:</b> ${data.reply}</div>`;
    box.scrollTop = box.scrollHeight;
  })
  .catch(() => {
    box.innerHTML += `<div style="color:red;">Error contacting AI</div>`;
  });
}
</script>

{% endblock %}
