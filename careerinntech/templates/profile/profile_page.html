{% extends "base.html" %}
{% load static %}

{% block extra_css %}
<link rel="stylesheet" href="{% static 'css/dashboard.css' %}">
{% endblock %}

{% block content %}

<section class="profile-container">

  <!-- HEADER -->
  <div class="profile-header">
    <h2>ðŸ‘¤ My Profile</h2>
    <p class="muted">Your learning & placement journey</p>
  </div>

  <!-- GRID -->
  <div class="profile-grid">

    <!-- LEFT : USER DETAILS -->
    <div class="profile-card">
      <h3>{{ user.username }}</h3>
      <p class="muted">{{ user.email }}</p>

      <ul class="profile-list">
        <li><strong>Track:</strong> {{ profile.track|title }}</li>
        <li><strong>Branch:</strong> {{ profile.branch }}</li>
        <li><strong>Year:</strong> {{ profile.year }}</li>
        <li><strong>Career Goal:</strong> {{ profile.career_goal }}</li>
      </ul>

      <a href="{% url 'edit_profile' %}" class="btn-primary small">
        Edit Profile
      </a>
    </div>

    <!-- RIGHT : PROGRESS -->
    <div class="profile-card">
      <h3>ðŸ“Š Your Progress</h3>

    <div class="chart-wrapper">
      <canvas id="progressChart"></canvas>
    </div>


      <!-- Skills -->
      <div class="progress-row">
        <span>Skills</span>
        <div class="progress-bar">
          <div class="progress-fill skills" style="width: {{ progress.skills }}%"></div>
        </div>
        <span class="progress-value">{{ progress.skills }}%</span>
      </div>

      <!-- Projects -->
      <div class="progress-row">
        <span>Projects</span>
        <div class="progress-bar">
          <div class="progress-fill projects" style="width: {{ progress.projects }}%"></div>
        </div>
        <span class="progress-value">{{ progress.projects }}%</span>
      </div>

      <!-- Placement -->
      <div class="progress-row">
        <span>Placement Prep</span>
        <div class="progress-bar">
          <div class="progress-fill placement" style="width: {{ progress.placement }}%"></div>
        </div>
        <span class="progress-value">{{ progress.placement }}%</span>
      </div>

      <!-- NEXT STEP -->
      <div class="next-step">
        <h4>ðŸŽ¯ Recommended Next Step</h4>
        <p>Start <strong>Placement Preparation â€“ Aptitude</strong></p>
        <a href="{% url 'placement_preparation' %}" class="link-btn">
          Go to Placement Prep â†’
        </a>
      </div>
    </div>

  </div>

</section>

<script>
const ctx = document.getElementById('progressChart');

if (ctx) {
  new Chart(ctx, {
    type: 'doughnut',
    data: {
      labels: ['Skills', 'Projects', 'Placement Prep'],
      datasets: [{
        data: [
          {{ progress.skills }},
          {{ progress.projects }},
          {{ progress.placement }}
        ],
        backgroundColor: ['#6366f1', '#10b981', '#38bdf8'],
        borderWidth: 0
      }]
    },
    options: {
      cutout: '70%',
      plugins: { legend: { display: false } }
    }
  });
}
</script>


{% endblock %}
