{% load static %}
<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>{% block title %}CareerInnTech{% endblock %}</title>
    <meta name="viewport" content="width=device-width, initial-scale=1.0">

    <!-- ================= GLOBAL CSS ================= -->
    <link rel="stylesheet" href="{% static 'css/base.css' %}">

    <!-- ================= PAGE LEVEL CSS ================= -->
    {% block extra_css %}{% endblock %}
</head>

<body>

<!-- ================= ALERT MESSAGES ================= -->
{% if messages %}
<div class="alert-container">
    {% for message in messages %}
        <div class="alert {{ message.tags }}">
            {{ message }}
        </div>
    {% endfor %}
</div>
{% endif %}

<!-- ================= HEADER ================= -->
<header class="main-header">
    <div class="header-left">
        <img id="logomain" src="{% static 'images/logomain.png' %}" alt="CareerInnTech Logo">

        <div class="logo">
            CareerInnTech
            <span>BTech ‚Ä¢ Hospitality ‚Ä¢ Careers</span>
        </div>
    </div>

    <nav class="header-nav compact">
        <a href="{% url 'dashboard' %}" class="nav-btn">Home</a>
        <a href="{% url 'about' %}" class="nav-btn">About</a>
        <a href="{% url 'contact' %}" class="nav-btn">Contact</a>
        <a href="{% url 'support' %}" class="nav-btn">Support</a>
    </nav>

    <div class="header-right">
        {% if user.is_authenticated %}
            <div class="profile-circle" onclick="toggleSidebar()">
                {{ user.username|first|upper }}
            </div>

            {% if not user.studentprofile.is_profile_complete %}
                <a href="{% url 'welcome' %}" class="primary-btn pulse-btn">
                    Complete Profile
                </a>
            {% else %}
                <a href="{% url 'edit_profile' %}" class="secondary-btn">
                    Edit Profile
                </a>
            {% endif %}

            <a href="{% url 'logout' %}" class="logout-btn">Logout</a>
        {% else %}
            <a href="{% url 'login' %}" class="login-btn">Login</a>
            <a href="{% url 'signup' %}" class="primary-btn">Sign Up</a>
        {% endif %}
    </div>
</header>

<!-- ================= PROFILE SIDEBAR ================= -->
{% if user.is_authenticated %}
<div id="profileSidebar" class="profile-sidebar">
    <div class="sidebar-header">
        <h3>My Profile</h3>
        <span class="close-btn" onclick="toggleSidebar()">‚úï</span>
    </div>

    <div class="sidebar-body">

        <div class="profile-avatar">
            {{ user.username|first|upper }}
        </div>

        <p class="profile-name">{{ user.username }}</p>
        <p class="profile-email">{{ user.email }}</p>

        {% if user.studentprofile.is_profile_complete %}
            <div class="profile-details">
                <div class="detail-card">
                    <span>Track</span>
                    <strong>{{ user.studentprofile.track|title }}</strong>
                </div>

                <div class="detail-card">
                    <span>Year</span>
                    <strong>{{ user.studentprofile.year }}</strong>
                </div>

                <div class="detail-card">
                    <span>Goal</span>
                    <strong>{{ user.studentprofile.career_goal }}</strong>
                </div>
            </div>
        {% else %}
            <p class="profile-warning">
                Your profile is incomplete.<br>
                Complete it to unlock personalized features.
            </p>
        {% endif %}

        <hr>

        {% if not user.studentprofile.is_profile_complete %}
            <a href="{% url 'welcome' %}" class="sidebar-link highlight-link">
                ‚ö†Ô∏è Complete Profile
            </a>
        {% else %}
            <a href="{% url 'edit_profile' %}" class="sidebar-link">
                ‚úèÔ∏è Edit Profile
            </a>
        {% endif %}

        <a href="#" class="sidebar-link">My Subscription</a>
        <a href="{% url 'support' %}" class="sidebar-link">Help & Support</a>

    </div>
</div>
{% endif %}

<!-- ================= MAIN CONTENT ================= -->
<main class="main-content">
    {% block content %}{% endblock %}
</main>

<!-- ================= SIDEBAR SCRIPT ================= -->
<script>
function toggleSidebar() {
    document.getElementById("profileSidebar").classList.toggle("open");
}
</script>

<!-- ================= AI CHATBOT ================= -->
<div id="aiChatbot">

  <!-- Floating Toggle -->
  <div id="chatbotToggle" onclick="toggleChatbot()">
    ü§ñ
  </div>

  <!-- AI Assistant Panel -->
  <div id="chatbotWindow">
    <div class="chatbot-header">
      <span>CareerInnTech AI</span>
      <button onclick="toggleChatbot()">‚úï</button>
    </div>

   <div class="chatbot-body">

  <div id="chatMessages" style="max-height:300px; overflow-y:auto;"></div>

  <div style="display:flex; gap:8px; margin-top:12px;">
    <input
      id="chatInput"
      type="text"
      placeholder="Ask your question..."
      style="flex:1; padding:10px; border-radius:10px; border:none;"
      onkeydown="if(event.key==='Enter') sendMessage()"
    />

    <button
      onclick="sendMessage()"
      style="padding:10px 14px; border-radius:10px; background:#6366f1; color:#fff; border:none;">
      Send
    </button>
  </div>

  <ul class="ai-points" style="margin-top:12px;">
    <li>‚úî Skills & roadmaps</li>
    <li>‚úî Colleges & cutoffs</li>
    <li>‚úî Jobs, exams & planning</li>
  </ul>

  <button class="ai-start-btn" onclick="startAIChat()">
  Start AI Chat
  </button>

  </div>

</div>

<script>
function toggleChatbot() {
    const bot = document.getElementById("chatbotWindow");
    bot.classList.toggle("open");
}
</script>
<script src="{% static 'js/base.js' %}"></script>


</body>
</html>
